{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "schema for spoke configuration file",
    "title": "spoke",
    "description": "Virtual Network configuration",
    "type": "object",
    "properties": {
        "addressPrefixes": {
            "description": "address prefixes to use for the virtual network",
            "type": "array",
            "items": {
                "description": "ip address prefix",
                "type": "string"
            }
        },

        "subnets": {
            "description": "subnets",
            "type": "object",
            "properties": {
                "private-endpoints": {
                    "description": "address prefix for private-endpoints subnet",
                    "type": "string",
                    "format": "ipv4"
                }
            },
            "patternProperties": {
                "^[a-zA-Z0-9-_]+$": {
                    "description": "address prefix for named subnet",
                    "type": "string",
                    "format": "ipv4"
                }
            },

            "required": ["private-endpoints"],
            "additionalProperties": false
        },

        "networkSecurityGroups": {
            "description": "security rules for network security groups",
            "type": "object",
            "properties": {
                "private-endpoints": {
                    "description": "names of security rules for private endpoints subnets",
                    "type": "array",
                    "items": {
                        "description": "security rule names as defined in nsgRules.jsonc",
                        "type": "string"
                    }
                }
            },
            "patternProperties": {
                "^[a-zA-Z0-9-_]+$": {
                    "description": "names of security rules for named subnet",
                    "type": "array",
                    "items": {
                        "description": "security rule names as defined in nsgRules.jsonc",
                        "type": "string"
                    }
                }
            },
            "required": ["private-endpoints"],
            "additionalProperties": false
        },
        "delegations": {
            "description": "define delegations for subnets",
            "type": "object",
            "patternProperties": {
                "^[a-zA-Z0-9-_]+$": {
                    "description": "delegations for named subnet",
                    "type": "array",
                    "items": {
                        "description": "delegated service name",
                        "type": "string"
                    }
                }
            },
            "additionalProperties": false
        }
    },

    "required": ["addressPrefixes", "subnets", "networkSecurityGroups"],
    "additionalProperties": false
}
